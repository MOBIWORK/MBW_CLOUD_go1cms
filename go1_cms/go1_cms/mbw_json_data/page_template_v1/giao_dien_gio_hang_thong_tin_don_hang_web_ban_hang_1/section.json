[{"name": "PS-24-0000012576", "owner": "Administrator", "creation": "2024-10-05 08:51:12.115707", "modified": "2024-10-15 16:19:25.372522", "modified_by": "Administrator", "docstatus": 0, "idx": 1, "section_title": "BreadCrumb web bán hàng 1", "route": "breadcrumb web b-n h-ng 1", "class_name": "hqecxast", "is_template": 0, "section_group": "Trang web bán hàng 1", "is_full_width": 0, "allow_clone": 1, "is_clone": 0, "section_type": "Static Section", "view_type": "", "device_type": "Web & Mobile", "is_editable": 0, "is_login_required": 0, "content_type": "", "fetch_product": 0, "section_name": "BreadCrumb web bán hàng 1", "image_option": "Same Document", "allow_update_to_style": 0, "query_by_category": 0, "no_of_records": 0, "sort_by": "DESC", "dynamic_data": 1, "display_data_randomly": 0, "image": "/files/Screenshot from 2024-10-04 16-07-41.png", "enable_view_more": 0, "custom_section_data": "[]", "bg_type": "Color", "bg_color": "#ffffff", "web_template": "<div class=\"bg-[white] container mb-[60px] rounded-b-md border border-solid border-grey\">\n          <div\n            class=\"breadcumb mx-auto container py-4 flex flex-wrap flex-row items-center justify-between gap-2\"\n          >\n                       <span class=\"text-sm font-semibold text-[#4B5966]\">{{ title }}</span>\n            <div class=\"flex flex-wrap flex-row items-center gap-2\">\n            {% for brc in breadcrumb %} \n             {% if loop.first %}\n               <a href=\"{{ brc.route }}\" class=\"text-sm font-normal text-[#212B36]\">{{ brc.menu }}</a>\n             {% elif not loop.last %}\n            <img\n              src=\"/files/no-active-arrown.svg\"\n              alt=\"\"\n              class=\"w-6 h-6\"\n            />\n            <a href=\"{{ brc.route }}\" class=\"text-sm font-normal text-[#212B36]\">{{ brc.menu }}</a>\n             {% else %}\n            <img\n              src=\"/files/active-arrown.svg\"\n              alt=\"\"\n              class=\"w-6 h-6\"\n            />\n            <a href=\"{{ brc.route }}\" class=\"text-sm font-normai text-[#1877F2]\"\n              >{{ brc.menu }}</a\n            >\n           {% endif %}\n           {% endfor %}\n           </div>\n\n          </div>\n        </div>", "doctype": "Page Section", "content": [{"name": "9f93430c4b", "owner": "Administrator", "creation": "2024-10-05 08:51:12.115707", "modified": "2024-10-15 16:19:25.372522", "modified_by": "Administrator", "docstatus": 0, "idx": 1, "field_label": "Đường dẫn", "field_key": "breadcrumb", "field_type": "List", "content_type": "Data", "allow_update_to_style": 0, "content": "[{\"menu\":\"Trang chủ\",\"route\":\"/home\",\"idx\":1},{\"menu\":\"Giỏ hàng\",\"route\":\"#\",\"idx\":2}]", "fields_json": "[{\"field_label\":\"Tiêu đề\",\"field_key\":\"menu\",\"field_type\":\"Text\",\"idx\":1},{\"field_label\":\"Đường dẫn\",\"field_key\":\"route\",\"field_type\":\"Text\",\"idx\":2}]", "parent": "PS-24-0000012576", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}, {"name": "e59a9bd456", "owner": "Administrator", "creation": "2024-10-05 08:51:12.115707", "modified": "2024-10-15 16:19:25.372522", "modified_by": "Administrator", "docstatus": 0, "idx": 2, "field_label": "Tiêu đề", "field_key": "title", "field_type": "Text", "content_type": "Data", "allow_update_to_style": 0, "content": "Giỏ hàng", "parent": "PS-24-0000012576", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}], "section_column_css": [], "column_index": 1}, {"name": "PS-24-0000014550", "owner": "Administrator", "creation": "2024-10-15 14:25:22.402730", "modified": "2024-10-15 14:25:22.412298", "modified_by": "Administrator", "docstatus": 0, "idx": 3, "section_title": "Thông tin giỏ hàng web bán hàng 1", "route": "th-ng tin gi- h-ng web b-n h-ng 1", "class_name": "httvxjsa", "is_template": 1, "section_group": "Trang web bán hàng 1", "is_full_width": 0, "allow_clone": 1, "is_clone": 0, "section_type": "Static Section", "view_type": "", "device_type": "Web & Mobile", "is_editable": 0, "is_login_required": 0, "content_type": "", "fetch_product": 0, "section_name": "Thông tin giỏ hàng web bán hàng 1", "image_option": "Same Document", "allow_update_to_style": 0, "query_by_category": 0, "no_of_records": 0, "sort_by": "DESC", "dynamic_data": 1, "display_data_randomly": 0, "image": "/files/Screenshot from 2024-07-03 09-54-45.png", "enable_view_more": 0, "custom_section_data": "[]", "bg_type": "Color", "bg_color": "#ffffff", "web_template": "<div class=\"container mx-auto my-10 pb-[30px] text-[#212B36] relative\">\n      <div id=\"loading\" class=\"loading-overlay absolute\">\n        <div class=\"spinner\"></div>\n      </div>\n      <div class=\"cart-items flex flex-col lg:flex-row justify-between lg:px-8  gap-[60px] hidden\">\n        <div class=\"w-full lg:w-4/6 bg-white pt-6 rounded-lg shadow-lg\">\n          <p class=\"font-bold text-lg leading-7 ml-4\">Giỏ hàng\n            (<span class=\"count\">0</span>)\n          </p>\n          <table class=\"w-full table-auto mt-6 rounded\">\n            <thead>\n              <tr class=\"text-left border-b bg-[#F4F6F8]\">\n                <th class=\"p-4 text-center\">Sản phẩm</th>\n                <th class=\"p-4 text-center\">Đơn giá</th>\n                <th class=\"p-4 text-left\">Số lượng</th>\n                <th class=\"p-4 text-center\">Thành tiền</th>\n              </tr>\n            </thead>\n            <tbody></tbody>\n          </table>\n        </div>\n        <div class=\"w-full lg:w-2/6\">\n          <div class=\"p-6 bg-white border rounded-lg shadow-lg h-fit\">\n            <h2 class=\"text-lg font-bold mb-4\">Chi tiết thanh toán</h2>\n            <div class=\"border-b border-dashed\">\n              <p class=\"mb-2 flex justify-between\">\n                Tổng tiền <span class=\"total-amount\">0 VND</span>\n              </p>\n              <p class=\"mb-2 flex justify-between\">\n                Giảm giá: <span class=\"discount\">-</span>\n              </p>\n              <p class=\"mb-2 flex justify-between\">\n                Phí vận chuyển: <span class=\"shipping-fee\">0 VND</span>\n              </p>\n            </div>\n    \n            <p class=\"mb-4 flex justify-between mt-4\">\n              Thành tiền:\n              <span class=\"final-amount text-red-500\">0 VND</span>\n            </p>\n          </div>\n          <button class=\"btn-checkout bg-[#5CAF90] text-white px-4 py-2 rounded-lg w-full mt-6\" id=\"btn-checkout-order\">\n            Tiến hành đặt hàng\n          </button>\n        </div>\n      </div>\n      <div class=\"empty-cart flex flex-col items-center justify-center h-full\">\n        <img src=\"{{img_empty}}\" alt=\"Giỏ hàng trống\" class=\"w-[242px] h-[308px] mb-4\" />\n        <a href=\"/san-pham\" class=\"font-bold text-sm border border-solid rounded-xl p-2\"><< {{ctn_buy}}</a>\n      </div>\n    </div>", "custom_css": "      /* Overlay for the entire screen */\n      .loading-overlay {\n        top: 50%;\n        transform: translateY(-50%);\n        width: 100%;\n        height: 100%;\n        background: rgba(255, 255, 255, 0.8);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 9999; /* Ensure it is above all other elements */\n        display: none; /* Hidden by default */\n      }\n\n      /* Spinner */\n      .spinner {\n        border: 4px solid rgba(0, 0, 0, 0.1);\n        border-top: 4px solid #3498db;\n        border-radius: 50%;\n        width: 40px;\n        height: 40px;\n        animation: spin 1s linear infinite;\n      }\n\n      /* Spinner animation */\n      @keyframes spin {\n        0% {\n          transform: rotate(0deg);\n        }\n        100% {\n          transform: rotate(360deg);\n        }\n      }\n\n      .overlay {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n        z-index: 999;\n      }\n\n      .text-hide {\n        display: -webkit-box;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 1; /* Số dòng hiển thị trước khi hiển thị dấu ba chấm */\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }", "custom_js": "<script>\n      document.addEventListener(\"DOMContentLoaded\", function () {\n        const totalAmount = document.querySelector(\".total-amount\");\n        const emptyCartMessage = document.querySelector(\".empty-cart\");\n        const finalAmount = document.querySelector(\".final-amount\");\n        const shippingFeeElement = document.querySelector(\".shipping-fee\");\n        const loadingIndicator = document.getElementById(\"loading\");\n        let cartItem;\n\n        function showLoading(show) {\n          // Hiển thị hoặc ẩn loading indicator\n          loadingIndicator.style.display = show ? \"flex\" : \"none\";\n        }\n\n        function updateTotal() {\n          let total = 0;\n          const remainingItems = document.querySelectorAll(\"tbody tr\");\n          remainingItems.forEach((item) => {\n            const subtotal = parseFloat(\n              item\n                .querySelector(\".subtotal\")\n                .textContent.replace(/đ/g, \"\")\n                .replace(/\\./g, \"\")\n                .replace(/,/g, \"\")\n            );\n            total += subtotal;\n          });\n          totalAmount.textContent = total.toLocaleString(\"vi-VN\") + \" VND\";\n\n          const shippingFee =\n            parseFloat(\n              shippingFeeElement.textContent\n                .replace(/\\./g, \"\")\n                .replace(/,/g, \"\")\n                .replace(/đ/g, \"\")\n            ) || 0;\n          const finalTotal = total + shippingFee;\n          finalAmount.textContent = finalTotal.toLocaleString(\"vi-VN\") + \" VND\";\n          checkEmptyCart();\n        }\n\n        function checkEmptyCart() {\n          const remainingItems = document.querySelectorAll(\"tbody tr\");\n          if (remainingItems.length === 0) {\n            document.querySelector(\".cart-items\").classList.add(\"hidden\");\n            emptyCartMessage.classList.remove(\"hidden\");\n          } else {\n            document.querySelector(\".cart-items\").classList.remove(\"hidden\");\n            emptyCartMessage.classList.add(\"hidden\");\n          }\n        }\n\n        // Initialize total calculation\n        const apiGetCart = \"/api/method/go1_cms.api.website.cart.get_cart\";\n\n        async function getCart() {\n          showLoading(true);\n          const response = await fetch(apiGetCart, {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              \"X-Frappe-CSRF-Token\": \"{{csrf_token}}\",\n            },\n          });\n          if (response.status === 403) {\n            window.location.href = \"/dang-nhap\";\n          } else if (!response.ok) {\n            showLoading(false);\n            throw new Error(\"Có lỗi xảy ra, vui lòng thử lại sau\");\n          }\n          const data = await response.json();\n          showLoading(false);\n          if (data.message) {\n            cartItem = data.message.items;\n            return data.message;\n          } else {\n            throw new Error(data.error);\n          }\n        }\n\n        const displayCart = () => {\n          if (cartItem) {\n            document.querySelector(\".count\").textContent = cartItem.length\n              ? cartItem.length\n              : 0;\n          }\n\n          cartItem.forEach((item) => {\n            const row = document.createElement(\"tr\");\n            row.className = \"border-b\";\n            row.innerHTML = `\n                      <td class=\"flex xl:flex-row flex-col items-center p-4\">\n                    <img\n                      src=\"${item.image}\"\n                      alt=\"${item.item_name}\"\n                      class=\"w-full md:w-12 h-12 lg:mr-4\"\n                    />\n                    <span class=\"flex text-center justify-center items-center\">${item.item_name}</span>\n                      </td>\n                      <td class=\"p-4 text-center\">${item.rate?.toLocaleString()} VND/ ${item.uom\n              }</td>\n                      <td class=\"p-4 text-left\">\n                    <div\n                      class=\"flex flex-col md:flex-row items-center border border-solid rounded-lg w-fit text-center\"\n                    >\n                      <button class=\"btn-decrease px-2 py-1\">-</button>\n                      <input type=\"number\" class=\"quantity w-[30px] mx-auto pl-[2px]\" value=\"${item.qty\n              }\" min=\"1\" max=\"999\" />\n                      <button class=\"btn-increase px-2 py-1\">+</button>\n                    </div>\n                      </td>\n                      <td class=\"p-4 text-center\">\n                    <div class=\"flex flex-col xl:flex-row justify-between\">\n                      <p class=\"subtotal\">${item.amount?.toLocaleString()} VND</p>\n                      <button class=\"btn-delete text-white px-2 py-1 rounded text-center flex justify-center\">\n                    <img\n                      src=\"/files/ic-solar_trash-bin-trash-bold.png\"\n                      alt=\"\"\n                      class=\"w-4 h-4\"\n                    />\n                      </button>\n                    </div>\n                       </td>\n                  `;\n\n            const btnDecrease = row.querySelector(\".btn-decrease\");\n            const btnIncrease = row.querySelector(\".btn-increase\");\n            const btnDelete = row.querySelector(\".btn-delete\");\n            const quantityElement = row.querySelector(\".quantity\");\n            const subtotalElement = row.querySelector(\".subtotal\");\n\n            quantityElement.addEventListener(\"change\", () => {\n              let quantity = parseInt(quantityElement.value);\n              if (isNaN(quantity) || quantity < 1) {\n                quantity = 1;\n                quantityElement.value = quantity;\n              } else if (quantity > 999) {\n                quantity = 999\n                quantityElement.value = quantity;\n              }\n              subtotalElement.textContent =\n                (item.rate * quantity)?.toLocaleString() + \" VND\";\n              addToCart(item.item_code, quantity);\n              updateTotal();\n            });\n\n            btnDecrease.addEventListener(\"click\", () => {\n              let quantity = parseInt(quantityElement.value);\n              if (quantity > 1) {\n                quantity--;\n                quantityElement.value = quantity;\n                subtotalElement.textContent =\n                  (item.rate * quantity)?.toLocaleString() + \" VND\";\n                addToCart(item.item_code, quantity);\n                updateTotal();\n              }\n            });\n\n            btnIncrease.addEventListener(\"click\", () => {\n              let quantity = parseInt(quantityElement.value);\n              if (quantity < 999) {\n                quantity++;\n                quantityElement.value = quantity;\n                subtotalElement.textContent =\n                  (item.rate * quantity)?.toLocaleString() + \" VND\";\n                addToCart(item.item_code, quantity);\n                updateTotal();\n              }\n            });\n\n            btnDelete.addEventListener(\"click\", () => {\n              row.remove();\n              quantityElement.value = 0;\n              addToCart(item.item_code, 0);\n              updateTotal();\n            });\n            document.querySelector(\"tbody\").appendChild(row);\n          });\n          updateTotal();\n        };\n\n        const apiAddToCart = \"/api/method/go1_cms.api.website.cart.update_cart\";\n\n        const addToCart = (itemCode, quantity) => {\n          showLoading(true);\n          fetch(apiAddToCart, {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n              item_code: itemCode,\n              qty: quantity,\n            }),\n          })\n            .then((response) => {\n              showLoading(false);\n              if (response.status === 403) {\n                window.location.href = \"/dang-nhap\";\n              } else if (!response.ok) {\n                Swal.fire({\n                  icon: \"error\",\n                  title: \"Có lỗi xảy ra, vui lòng thử lại sau\",\n                  showConfirmButton: false,\n                  timer: 1500,\n                });\n                throw new Error(\"Có lỗi xảy ra, vui lòng thử lại sau\");\n              } else {\n                return response.json();\n              }\n            })\n            .then((result) => {\n              // Sử dụng để lấy cookie 'cart'\n              cartItem = getCartCookie();\n              Swal.fire({\n                position: \"top-end\",\n                icon: \"success\",\n                title: \"Cập nhật vào giỏ hàng thành công\",\n                showConfirmButton: false,\n                timer: 1500,\n                toast: true,\n              });\n              updateDisplayCart();\n            })\n            .catch((error) => {\n              console.error(\"Error:\", error);\n            });\n        };\n\n        const getCartCookie =()=> {\n          const cartCookie = getCookie(\"cart\");\n\n          if (cartCookie) {\n            try {\n              // Dùng JSON.parse để chuyển chuỗi JSON thành đối tượng JavaScript\n              const cartObject = JSON.parse(decodeURIComponent(cartCookie));\n              return cartObject;\n            } catch (error) {\n              console.error(\"Lỗi khi phân tích JSON từ cookie:\", error);\n            }\n          } else {\n          }\n\n          return null;\n        }\n\n        getCart().then(() => {\n          displayCart();\n        });\n        updateDisplayCart();\n\n        document\n          .getElementById(\"btn-checkout-order\")\n          .addEventListener(\"click\", () => {\n            window.location.href = \"/thanh-toan\";\n          });\n      });\n\n    </script>", "doctype": "Page Section", "content": [{"name": "7bb5a3099b", "owner": "Administrator", "creation": "2024-10-15 14:25:22.402730", "modified": "2024-10-15 14:25:22.412298", "modified_by": "Administrator", "docstatus": 0, "idx": 1, "field_label": "Ảnh giỏ hàng trống", "field_key": "img_empty", "field_type": "Attach", "content_type": "Data", "allow_update_to_style": 0, "content": "/files/stack.png", "parent": "PS-24-0000014550", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}, {"name": "f72205af18", "owner": "Administrator", "creation": "2024-10-15 14:25:22.402730", "modified": "2024-10-15 14:25:22.412298", "modified_by": "Administrator", "docstatus": 0, "idx": 2, "field_label": "Nhãn link mua sắm", "field_key": "ctn_buy", "field_type": "Text", "content_type": "Data", "allow_update_to_style": 0, "content": "Tiếp tục mua sắm", "parent": "PS-24-0000014550", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}], "section_column_css": [], "column_index": 1}]