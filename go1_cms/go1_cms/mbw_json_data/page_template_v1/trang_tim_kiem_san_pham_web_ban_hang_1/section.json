[{"name": "PS-24-0000012564", "owner": "Administrator", "creation": "2024-10-05 08:46:59.869217", "modified": "2024-10-15 16:18:43.884450", "modified_by": "Administrator", "docstatus": 0, "idx": 1, "section_title": "BreadCrumb web bán hàng 1", "route": "breadcrumb web b-n h-ng 1", "class_name": "bytetzgo", "is_template": 0, "section_group": "Trang web bán hàng 1", "is_full_width": 0, "allow_clone": 1, "is_clone": 0, "section_type": "Static Section", "view_type": "", "device_type": "Web & Mobile", "is_editable": 0, "is_login_required": 0, "content_type": "", "fetch_product": 0, "section_name": "BreadCrumb web bán hàng 1", "image_option": "Same Document", "allow_update_to_style": 0, "query_by_category": 0, "no_of_records": 0, "sort_by": "DESC", "dynamic_data": 1, "display_data_randomly": 0, "image": "/files/Screenshot from 2024-10-04 16-07-41.png", "enable_view_more": 0, "custom_section_data": "[]", "bg_type": "Color", "bg_color": "#ffffff", "web_template": "<div class=\"bg-[white] container mb-[60px] rounded-b-md border border-solid border-grey\">\n          <div\n            class=\"breadcumb mx-auto container py-4 flex flex-wrap flex-row items-center justify-between gap-2\"\n          >\n                       <span class=\"text-sm font-semibold text-[#4B5966]\">{{ title }}</span>\n            <div class=\"flex flex-wrap flex-row items-center gap-2\">\n            {% for brc in breadcrumb %} \n             {% if loop.first %}\n               <a href=\"{{ brc.route }}\" class=\"text-sm font-normal text-[#212B36]\">{{ brc.menu }}</a>\n             {% elif not loop.last %}\n            <img\n              src=\"/files/no-active-arrown.svg\"\n              alt=\"\"\n              class=\"w-6 h-6\"\n            />\n            <a href=\"{{ brc.route }}\" class=\"text-sm font-normal text-[#212B36]\">{{ brc.menu }}</a>\n             {% else %}\n            <img\n              src=\"/files/active-arrown.svg\"\n              alt=\"\"\n              class=\"w-6 h-6\"\n            />\n            <a href=\"{{ brc.route }}\" class=\"text-sm font-normai text-[#1877F2]\"\n              >{{ brc.menu }}</a\n            >\n           {% endif %}\n           {% endfor %}\n           </div>\n\n          </div>\n        </div>", "doctype": "Page Section", "content": [{"name": "a49d70bdb9", "owner": "Administrator", "creation": "2024-10-05 08:46:59.869217", "modified": "2024-10-15 16:18:43.884450", "modified_by": "Administrator", "docstatus": 0, "idx": 1, "field_label": "Đường dẫn", "field_key": "breadcrumb", "field_type": "List", "content_type": "Data", "allow_update_to_style": 0, "content": "[{\"menu\":\"Trang chủ\",\"route\":\"/home\",\"idx\":1},{\"menu\":\"Sản phẩm\",\"route\":\"#\",\"idx\":2}]", "fields_json": "[{\"field_label\":\"Tiêu đề\",\"field_key\":\"menu\",\"field_type\":\"Text\",\"idx\":1},{\"field_label\":\"Đường dẫn\",\"field_key\":\"route\",\"field_type\":\"Text\",\"idx\":2}]", "parent": "PS-24-0000012564", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}, {"name": "6efec4033e", "owner": "Administrator", "creation": "2024-10-05 08:46:59.869217", "modified": "2024-10-15 16:18:43.884450", "modified_by": "Administrator", "docstatus": 0, "idx": 2, "field_label": "Tiêu đề", "field_key": "title", "field_type": "Text", "content_type": "Data", "allow_update_to_style": 0, "content": "Sản phẩm", "parent": "PS-24-0000012564", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}], "section_column_css": [], "column_index": 1}, {"name": "PS-24-0000015017", "owner": "Administrator", "creation": "2024-10-16 11:47:09.637779", "modified": "2024-10-16 11:47:09.646404", "modified_by": "Administrator", "docstatus": 0, "idx": 3, "section_title": "Trang tìm kiếm sản phẩm web bán hàng 1", "route": "trang t-m ki-m s-n ph-m web b-n h-ng 1", "class_name": "ikhrxvaq", "is_template": 1, "section_group": "Trang web bán hàng 1", "is_full_width": 0, "allow_clone": 1, "is_clone": 0, "section_type": "Static Section", "view_type": "", "device_type": "Web & Mobile", "is_editable": 0, "is_login_required": 0, "content_type": "", "fetch_product": 0, "section_name": "Trang tìm kiếm sản phẩm web bán hàng 1", "image_option": "Same Document", "allow_update_to_style": 0, "query_by_category": 0, "no_of_records": 0, "sort_by": "DESC", "dynamic_data": 1, "display_data_randomly": 0, "image": "/files/Screenshot from 2024-07-03 14-30-01.png", "enable_view_more": 0, "custom_section_data": "[]", "bg_type": "Color", "bg_color": "#ffffff", "web_template": "    <section\n      class=\"min-h-screen flex flex-col items-center my-10\"\n      id=\"list-products-filter\"\n    >\n      <div class=\"container\">\n        <section class=\"w-full container mx-auto\">\n          <div class=\"flex-col text-center\">\n            <div class=\"relative grid grid-cols-1 xl:grid-cols-4 xl:gap-4\">\n              <div id=\"loading\" class=\"loading-overlay absolute\">\n                <div class=\"spinner\"></div>\n              </div>\n              <div class=\"filter display mb-5\" id=\"filter\">\n                <div\n                  class=\"relative flex flex-col border text-left border-l-gray-500 border-none md:border md:border-solid md:border-[#DFE3E8] bg-white rounded-l-lg md:rounded-lg h-full w-[88%] overflow-y-auto\"\n                >\n                  <form class=\"p-4\" id=\"form-filter\">\n                    <div class=\"relative mb-4\">\n                      <input\n                        type=\"text\"\n                        placeholder=\"Tìm kiếm...\"\n                        class=\"w-full p-2 pl-4 pr-10 border rounded-md\"\n                        id=\"text-search\"\n                      />\n                      <span\n                        class=\"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400\"\n                      >\n                        <svg\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          class=\"h-5 w-5\"\n                          viewBox=\"0 0 20 20\"\n                          fill=\"currentColor\"\n                        >\n                          <path\n                            fill-rule=\"evenodd\"\n                            d=\"M12.9 14.32a8 8 0 111.41-1.41l4.3 4.29-1.41 1.42-4.3-4.3zM8 14a6 6 0 100-12 6 6 0 000 12z\"\n                            clip-rule=\"evenodd\"\n                          />\n                        </svg>\n                      </span>\n                    </div>\n\n                    <div class=\"mb-4\" id=\"filter-container\"></div>\n                  </form>\n                </div>\n                <!-- button close filter -->\n                <button\n                  id=\"button-close-filter\"\n                  class=\"xl:hidden absolute top-1/2 -translate-y-1/2 left-0 z-[999999999] text-white bg-[#212B36] w-[12%] h-12 rounded-l-lg\"\n                >\n                  x\n                </button>\n              </div>\n              <div class=\"overlay\" id=\"overlay\"></div>\n\n              <div class=\"col-span-3 grid grid-cols-1 gap-7 pb-14 mx-5 sm:mx-0\">\n                <div class=\"flex justify-between items-center h-[50px]\">\n                  <span class=\"text-[22px] font-bold text-[#212B36]\"\n                    >{{title}}</span\n                  >\n                  <div class=\"flex gap-2\">\n                    <label\n                      for=\"sort-by-default\"\n                      class=\"text-base font-normal text-black text-nowrap flex items-center\"\n                      >Sắp xếp theo</label\n                    >\n                    <select\n                      id=\"sort-by-default\"\n                      class=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 flex items-center\"\n                    >\n                      <option value=\"\">Mặc định</option>\n                      <option value=\"ranking\">Nổi bật</option>\n                      <option value=\"creation\">Mới nhất</option>\n                    </select>\n                  </div>\n                </div>\n                <div\n                  class=\"text-left grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10\"\n                  id=\"products-container\"\n                ></div>\n                <div\n                  id=\"pagination-container\"\n                  class=\"flex justify-center gap-2 hidden\"\n                >\n                  <button id=\"prev-page\" class=\"px-2 py-[1px] text-xl\">\n                    <svg\n                      class=\"h-4\"\n                      viewBox=\"0 0 7 12\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M6.83938 2.06621V1.03094C6.83938 0.941211 6.73625 0.891658 6.66661 0.946568L0.629107 5.66219C0.57781 5.70209 0.536302 5.75317 0.50775 5.81154C0.479198 5.86992 0.464355 5.93404 0.464355 5.99902C0.464355 6.06401 0.479198 6.12813 0.50775 6.18651C0.536302 6.24488 0.57781 6.29596 0.629107 6.33585L6.66661 11.0515C6.73759 11.1064 6.83938 11.0568 6.83938 10.9671V9.93184C6.83938 9.86621 6.80857 9.80327 6.75768 9.76309L1.93625 5.99969L6.75768 2.23496C6.80857 2.19478 6.83938 2.13184 6.83938 2.06621Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                  </button>\n                  <button id=\"next-page\" class=\"px-2 py-[1px] text-xl\">\n                    <svg\n                      class=\"h-4\"\n                      viewBox=\"0 0 7 12\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M6.39777 5.66281L0.360269 0.947189C0.344493 0.934768 0.325533 0.92705 0.305568 0.924919C0.285603 0.922788 0.265441 0.926332 0.247399 0.935143C0.229357 0.943955 0.214166 0.957676 0.203571 0.974732C0.192976 0.991787 0.187406 1.01149 0.187501 1.03156V2.06683C0.187501 2.13246 0.218305 2.1954 0.269198 2.23558L5.09063 6.00031L0.269198 9.76505C0.216966 9.80522 0.187501 9.86817 0.187501 9.9338V10.9691C0.187501 11.0588 0.290626 11.1083 0.360269 11.0534L6.39777 6.33781C6.44908 6.29779 6.4906 6.24658 6.51915 6.1881C6.5477 6.12962 6.56254 6.06539 6.56254 6.00031C6.56254 5.93523 6.5477 5.87101 6.51915 5.81253C6.4906 5.75404 6.44908 5.70284 6.39777 5.66281Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n      </div>\n    </section>\n    <button class=\"filter-toggle\" id=\"filterToggle\">\n      <i class=\"fa fa-filter w-6 h-6\" aria-hidden=\"true\"></i>\n    </button>", "custom_css": "      .text-container {\n        display: -webkit-box;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 3; /* Số dòng hiển thị trước khi hiển thị dấu ba chấm */\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n\n      .text-hide {\n        display: -webkit-box;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 1; /* Số dòng hiển thị trước khi hiển thị dấu ba chấm */\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n\n      .active-icon-view .icon path,\n      .view-icon:hover .icon path {\n        fill: white;\n      }\n\n      .active-icon-view {\n        background-color: #225771;\n      }\n\n      input[type=\"checkbox\"]:checked + label {\n        font-weight: bold;\n      }\n\n      input[type=\"checkbox\"].custom-checkbox {\n        appearance: none;\n        -webkit-appearance: none;\n        width: 16px;\n        height: 16px;\n        background-color: white;\n        border: 2px solid black;\n        border-radius: 0; /* Để tạo hình vuông */\n        position: relative;\n      }\n\n      input[type=\"checkbox\"].custom-checkbox:checked::before {\n        content: \"\";\n        display: block;\n        width: 8px;\n        height: 8px;\n        background-color: black;\n        position: absolute;\n        top: 2px;\n        left: 2px;\n      }\n\n      .page-number.active {\n        border: 1px solid #c4161c;\n        color: #c4161c;\n        border-radius: 4px;\n        font-weight: 500;\n      }\n\n      .no-active {\n        color: gray;\n        pointer-events: none;\n      }\n\n      /* Overlay for the entire screen */\n      .loading-overlay {\n        top: 50%;\n        transform: translateY(-50%);\n        width: 100%;\n        height: 100%;\n        background: rgba(255, 255, 255, 0.8);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 9999; /* Ensure it is above all other elements */\n        display: none; /* Hidden by default */\n      }\n\n      /* Spinner */\n      .spinner {\n        border: 4px solid rgba(0, 0, 0, 0.1);\n        border-top: 4px solid #3498db;\n        border-radius: 50%;\n        width: 40px;\n        height: 40px;\n        animation: spin 1s linear infinite;\n      }\n\n      /* Spinner animation */\n      @keyframes spin {\n        0% {\n          transform: rotate(0deg);\n        }\n        100% {\n          transform: rotate(360deg);\n        }\n      }\n\n      .filter-toggle {\n        display: none;\n        position: fixed;\n        right: 0;\n        top: 50%;\n        transform: translateY(-50%);\n        background: #212b36;\n        color: white;\n        border: none;\n        padding: 10px;\n        border-radius: 5px;\n        cursor: pointer;\n        width: 64px;\n        height: 48px;\n      }\n\n      .overlay {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n        z-index: 999;\n      }\n\n      @media (max-width: 1280px) {\n        .filter {\n          position: fixed;\n          top: 0;\n          right: 0;\n          height: 100%;\n          width: 70%;\n          z-index: 1000;\n          transform: translateX(-100%);\n          transition: transform 0.3s ease;\n          overflow-y: auto;\n          display: flex;\n          justify-content: flex-end;\n          background-color: rgba(0, 0, 0, -0.5);\n        }\n\n        .display {\n          display: none;\n        }\n\n        .filter.active {\n          transform: translateX(0);\n        }\n\n        .filter-toggle {\n          display: block;\n        }\n\n        .overlay.active {\n          display: block;\n        }\n      }", "custom_js": "<script>\n    const filterToggle = document.getElementById(\"filterToggle\");\n    const filter = document.getElementById(\"filter\");\n    const closeButton = document.getElementById(\"button-close-filter\");\n    const overlay = document.getElementById(\"overlay\");\n    const sortBy = document.getElementById(\"sort-by-default\");\n\n    filterToggle.addEventListener(\"click\", function () {\n      filter.classList.add(\"active\");\n      filter.classList.remove(\"display\");\n      overlay.classList.toggle(\"active\");\n    });\n    closeButton.addEventListener(\"click\", () => {\n      filter.classList.add(\"display\");\n      filter.classList.remove(\"active\");\n      overlay.classList.remove(\"active\");\n    });\n\n    overlay.addEventListener(\"click\", function () {\n      filter.classList.remove(\"active\");\n      overlay.classList.remove(\"active\");\n      filter.classList.add(\"display\");\n    });\n\n    const apiGetFilter =\n      \"/api/method/go1_cms.api.website.product.get_filter_product\";\n    const apiGetProduct =\n      \"/api/method/go1_cms.api.website.product.get_product_filter_data\";\n\n    const textSearch = document.getElementById(\"text-search\");\n    const filterContainer = document.getElementById(\"filter-container\");\n    const productContainer = document.getElementById(\"products-container\");\n    const formFilter = document.getElementById(\"form-filter\");\n    const loadingIndicator = document.getElementById(\"loading\");\n\n    const searchParams = new URLSearchParams(window.location.search);\n\n    let itemGroup = [];\n    let itemBrand = [];\n    let itemAttributeFilter = [];\n    let currentPage = 1;\n    let totalPages = 1;\n    let changeTimer; // Timer identifier\n    let changeInterval = 2009; // Thời gian chờ (ms)\n\n    // code update url\n    const updateUrl = (data) => {\n      if (!data || typeof data !== 'object') {\n        return;\n      }\n      const params = new URLSearchParams();\n      // Duyệt qua các thuộc tính của object `data` và thêm chúng vào params\n      Object?.keys(data).forEach((key) => {\n        if (Array.isArray(data[key])) {\n          // Nếu là mảng, thì thêm từng giá trị của mảng vào params với cùng một key\n          data[key].forEach((value) => params.append(key, value));\n        } else {\n          // Nếu không phải mảng, thêm trực tiếp vào params\n          params.set(key, data[key]);\n        }\n      });\n\n      const newUrl = `${window.location.pathname\n        }?page_no=${currentPage}&${params.toString()}`;\n      history.replaceState(null, \"\", newUrl);\n    };\n\n    // code tao list filter\n\n    const getFilter = async () => {\n      fetch(apiGetFilter, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      })\n        .then((response) => response.json())\n        .then((result) => {\n          displayFilterProduct(result.message);\n          for (const filter of result.message.attribute_filters) {\n            itemAttributeFilter.push(filter.key);\n          }\n          updateUrl();\n        })\n        .catch((error) => {\n          console.error(\"Error:\", error);\n        })\n        .finally(() => {\n          // Kích hoạt lại các thành phần UI bị vô hiệu hóa\n          restoreCheckboxesFromURL(\"item_group\", \"item_group\");\n          restoreCheckboxesFromURL(\"brand\", \"brand\");\n          for (const filter of itemAttributeFilter) {\n            restoreCheckboxesFromURL(`${filter}`, `${filter}`);\n          }\n          getProducts();\n        });\n    };\n\n    const translateNameFilter = (name) => {\n      switch (name) {\n        case \"Item Group\":\n          return \"Nhóm sản phẩm\";\n        case \"Brand\":\n          return \"Thương hiệu\";\n        default:\n          return name;\n      }\n    };\n\n    const displayFilterProduct = (filters) => {\n      for (const filter of filters?.field_filters) {\n        const filterElement = document.createElement(\"div\");\n        filterElement.className = \"mb-4\";\n        // tao title\n        const title = document.createElement(\"h3\");\n        title.className = \"font-semibold mb-2 text-left\";\n        title.textContent = translateNameFilter(filter.label);\n        filterElement.appendChild(title);\n        // tao list filter\n\n        for (const item of filter.values) {\n          const filterItem = document.createElement(\"div\");\n          filterItem.className = \"filter-item flex items-center mb-2\";\n          filterItem.innerHTML = `\n    <input \n       type=\"checkbox\" \n       id=\"${item}\" \n       name=\"${filter.key}\" \n       value=\"${item}\" \n       class=\"custom-checkbox\"\n    />\n    <label for=\"${item}\" class=\"cursor-pointer ml-2\">${item}</label>\n  `;\n          filterElement.appendChild(filterItem);\n        }\n\n        filterContainer.appendChild(filterElement);\n      }\n      if (filters?.attribute_filters) {\n        for (const filter of filters.attribute_filters) {\n          const filterElement = document.createElement(\"div\");\n          filterElement.className = \"mb-4\";\n\n          // Create title\n          const title = document.createElement(\"h3\");\n          title.className = \"font-semibold mb-2 text-left\";\n          title.textContent = translateNameFilter(filter.label);\n          filterElement.appendChild(title);\n\n          // Create list of filter items\n          for (const item of filter.values) {\n            const filterItem = document.createElement(\"div\");\n            filterItem.className = \"flex items-center mb-2\";\n            filterItem.innerHTML = `\n          <input \n            type=\"checkbox\" \n            id=\"${item}\" \n            name=\"${filter.key}\" \n            value=\"${item}\" \n            class=\"custom-checkbox\"\n          />\n          <label for=\"${item}\" class=\"cursor-pointer ml-2\">${item}</label>\n        `;\n            filterElement.appendChild(filterItem);\n          }\n\n          filterContainer.appendChild(filterElement);\n        }\n      }\n    };\n\n    getFilter();\n\n    // lay lai gia tri tu url\n    // Luu data\n\n    function restoreCheckboxesFromURL(paramName, inputName) {\n      const searchParams = new URLSearchParams(window.location.search);\n\n      searchParams.getAll(paramName).forEach((value) => {\n        const checkbox = document.querySelector(\n          `input[name=\"${inputName}\"][value=\"${value}\"]`\n        );\n        if (checkbox) checkbox.checked = true;\n      });\n    }\n\n    // code lay du lieu san pham\n\n    const getProducts = () => {\n      disableUI(true);\n      showLoading(true);\n      const getDataFilterFormCheckBox = (input, array, isNumber) => {\n        array.length = 0;\n        document.querySelectorAll(input + \":checked\").forEach((checkbox) => {\n          if (isNumber) {\n            array.push(parseFloat(checkbox.value));\n          } else {\n            array.push(checkbox.value);\n          }\n          return array;\n        });\n      };\n      getDataFilterFormCheckBox('input[name=\"item_group\"]', itemGroup);\n      getDataFilterFormCheckBox('input[name=\"brand\"]', itemBrand);\n\n      const data = {\n        textSearch: textSearch.value,\n        item_group: itemGroup,\n        brand: itemBrand,\n      };\n\n      for (const filter of itemAttributeFilter) {\n        const nameFilter = [];\n        getDataFilterFormCheckBox(`input[name=\"${filter}\"]`, nameFilter);\n        data[filter] = nameFilter;\n      }\n      updateUrl(data);\n\n      const attributeFilters = {};\n      const fieldFilters = {};\n\n      // Assuming `itemAttributeFilter` contains keys like 'Colour'\n      for (const key in data) {\n        if (key !== \"textSearch\") {\n          if (itemAttributeFilter.includes(key)) {\n            attributeFilters[key] = data[key];\n          } else {\n            fieldFilters[key] = data[key];\n          }\n        }\n      }\n      // Kiểm tra xem đối tượng attributeFilters có chứa mảng không rỗng, nếu có thì thêm vào mảng filterdAttributeFilters\n      const filteredAttributeFilters = Object.keys(attributeFilters).reduce(\n        (result, key) => {\n          if (attributeFilters[key].length > 0) {\n            result[key] = attributeFilters[key];\n          }\n          return result;\n        },\n        {}\n      );\n\n      // Kiểm tra xem đối tượng fieldFilters có chứa mảng không rỗng, nếu có thì thêm vào mảng filterdFieldFilters\n      const filteredFieldFilters = Object.keys(fieldFilters).reduce(\n        (result, key) => {\n          if (fieldFilters[key].length > 0) {\n            result[key] = fieldFilters[key];\n          }\n          return result;\n        },\n        {}\n      );\n      let queryString = \"&\";\n      if (Object.keys(filteredAttributeFilters).length > 0) {\n        queryString += `attribute_filters=${JSON.stringify(\n          filteredAttributeFilters\n        )}`;\n      }\n      if (Object.keys(filteredFieldFilters).length > 0) {\n        if (queryString) queryString += \"&\";\n        queryString += `field_filters=${JSON.stringify(filteredFieldFilters)}`;\n      }\n\n      fetch(`${apiGetProduct}?page_no=${currentPage}${queryString}&sort_field=${sortBy.value || \"\"\n        }`, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      })\n        .then((response) => response.json())\n        .then((result) => {\n          if (result.message.data) {\n            totalPages = result.message.pagination.total_page;\n            currentPage = result.message.pagination.current_page;\n            itemsPerPage = result.message.pagination.limit;\n            displayProduct(result.message.data);\n          }\n        })\n        .catch((error) => {\n          console.error(\"Error:\", error);\n          disableUI(false);\n          showLoading(false);\n        })\n        .finally(() => {\n          // Kích hoạt lại các thành phần UI bị vô hiệu hóa\n          disableUI(false);\n          showLoading(false);\n          displayStar();\n        });\n    };\n\n    // hieen thi san pham\n    const displayProduct = (products) => {\n      productContainer.innerHTML = \"\";\n      if (products.length === 0) {\n        const emptyElement = document.createElement(\"div\");\n        emptyElement.className =\n          \"flex flex-col justify-center items-center gap-[38px] py-[80px] col-span-full mt-[38px]\";\n        emptyElement.innerHTML = `\n<img src=\"/files/empty-state.svg\" alt=\"\" class=\"w-[245.64px] h-[236.85px]\"></img>\n<span class=\"text-[#212B36] font-bold text-xl\">Không có kết quả tìm kiếm </span>\n`;\n        productContainer.appendChild(emptyElement);\n      } else {\n        for (const product of products) {\n          const productElement = document.createElement(\"div\");\n\n          productElement.className =\n            \"bg-white shadow-lg rounded-lg overflow-hidden\";\n          productElement.innerHTML = `\n        <a class=\"relative\" href=\"/${product.route}\">\n            <img\n            class=\"w-full h-56 object-cover object-center\"\n            src=\"${product.website_image}\"\n            alt=\"${product.web_item_name}\"\n            />\n        </a>\n    <div class=\"p-4\">\n        <div class=\"text-xs text-[#212B36] mb-1 font-normal\">${product.item_group\n            }</div>\n        <a href=\"/${product.route\n            }\" class=\"text-base font-semibold text-[#212B36] mb-2 hover:text-red-500\">\n        ${product.web_item_name}\n        </a>\n        <div class=\"flex items-center mb-3\">\n        <div class=\"star-container\" data-rating=\"${product.ranking}\">\n            <span class=\"fa fa-star\"></span>\n            <span class=\"fa fa-star\"></span>\n            <span class=\"fa fa-star\"></span>\n            <span class=\"fa fa-star\"></span>\n            <span class=\"fa fa-star\"></span>\n        </div>\n        </div>\n        <div class=\"flex items-center\">\n            <span class=\"text-[#FF5E14] font-normal text-xl\">\n            ${(product.price_list_rate ? product.price_list_rate?.toLocaleString() : '0') + \" VND\"}\n            </span>\n        </div>\n        <div class=\"mt-4 flex items-center space-x-2\">\n        <a href=\"/${product.route}\">\n        <button class=\"flex items-center justify-center rounded-lg p-2\">\n            <svg\n            width=\"41\"\n            height=\"41\"\n            viewBox=\"0 0 41 41\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            >\n            <rect\n                x=\"0.600098\"\n                y=\"0.75\"\n                width=\"40\"\n                height=\"40\"\n                rx=\"8\"\n                fill=\"#22C55E\"\n                fill-opacity=\"0.16\"\n            />\n            <path\n                d=\"M31.4985 20.293C31.4517 20.2148 31.1782 19.7773 30.6782 18.9805C30.1938 18.1836 29.4907 17.3242 28.5688 16.4023C27.647 15.4805 26.522 14.6367 25.1938 13.8711C23.8501 13.1211 22.3188 12.7461 20.6001 12.7461C18.8813 12.7461 17.3501 13.1211 16.0063 13.8711C14.6782 14.6367 13.5532 15.4805 12.6313 16.4023C11.7095 17.3242 11.0063 18.1836 10.522 18.9805C10.022 19.7773 9.74854 20.2148 9.70166 20.293C9.67041 20.3555 9.64697 20.4258 9.63135 20.5039C9.61572 20.582 9.60791 20.6602 9.60791 20.7383C9.60791 20.832 9.61572 20.918 9.63135 20.9961C9.64697 21.0742 9.67822 21.1445 9.7251 21.207H9.70166C9.74854 21.2852 10.022 21.7227 10.522 22.5195C11.0063 23.3164 11.7095 24.1758 12.6313 25.0977C13.5532 26.0195 14.6782 26.8555 16.0063 27.6055C17.3501 28.3711 18.8813 28.7539 20.6001 28.7539C22.3188 28.7539 23.8501 28.3711 25.1938 27.6055C26.522 26.8555 27.647 26.0195 28.5688 25.0977C29.4907 24.1758 30.1938 23.3164 30.6782 22.5195C31.1782 21.7227 31.4517 21.2852 31.4985 21.207C31.5298 21.1445 31.5532 21.0742 31.5688 20.9961C31.5845 20.918 31.5923 20.832 31.5923 20.7383C31.5923 20.6602 31.5845 20.582 31.5688 20.5039C31.5532 20.4258 31.522 20.3477 31.4751 20.2695L31.4985 20.293ZM20.6001 24.7461C19.4907 24.7461 18.5454 24.3555 17.7642 23.5742C16.9829 22.793 16.5923 21.8477 16.5923 20.7383C16.5923 19.6445 16.9829 18.707 17.7642 17.9258C18.5454 17.1445 19.4907 16.7539 20.6001 16.7539C21.7095 16.7539 22.6548 17.1445 23.436 17.9258C24.2173 18.707 24.6079 19.6445 24.6079 20.7383C24.6079 21.8477 24.2173 22.793 23.436 23.5742C22.6548 24.3555 21.7095 24.7461 20.6001 24.7461ZM22.5923 20.7383C22.5923 21.3008 22.397 21.7773 22.0063 22.168C21.6157 22.5586 21.147 22.7539 20.6001 22.7539C20.0532 22.7539 19.5845 22.5586 19.1938 22.168C18.8032 21.7773 18.6079 21.3008 18.6079 20.7383C18.6079 20.1914 18.8032 19.7227 19.1938 19.332C19.5845 18.9414 20.0532 18.7461 20.6001 18.7461C21.147 18.7461 21.6157 18.9414 22.0063 19.332C22.397 19.7227 22.5923 20.1914 22.5923 20.7383Z\"\n                fill=\"#5CAF90\"\n            />\n            </svg>\n        </button>\n        </a>\n        <button\n            class=\"add-to-carts flex-1 flex gap-2 justify-center items-center bg-[#5CAF90] text-white text-sm font-bold py-[9.5px] px-2 rounded-lg hover:text-[#5CAF90] hover:bg-white icon-hover hover:border hover:border-solid hover:border-[#5CAF90]\"\n            item-code = \"${product.item_code}\"\n        >\n            <svg\n            width=\"25\"\n            height=\"25\"\n            viewBox=\"0 0 25 25\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            class=\"icon\"\n            >\n            <path\n                fill-rule=\"evenodd\"\n                clip-rule=\"evenodd\"\n                d=\"M10.5999 3C10.2686 2.99984 9.94403 3.09373 9.66398 3.27075C9.38392 3.44777 9.15988 3.70066 9.01789 4C8.33389 4.006 7.80189 4.037 7.32589 4.223C6.75766 4.44527 6.26348 4.82301 5.89989 5.313C5.53289 5.806 5.35989 6.44 5.12389 7.311L5.07689 7.481L4.56389 10.445C4.37889 10.573 4.21789 10.725 4.07789 10.904C3.17689 12.057 3.60589 13.774 4.46389 17.205C5.00889 19.388 5.28189 20.479 6.09589 21.115C6.90989 21.75 8.03489 21.75 10.2849 21.75H14.9149C17.1649 21.75 18.2899 21.75 19.1039 21.115C19.9179 20.479 20.1899 19.388 20.7359 17.205C21.5939 13.773 22.0229 12.058 21.1219 10.904C20.9841 10.7266 20.8199 10.5714 20.6349 10.444L20.1219 7.482L20.0759 7.312C19.8389 6.44 19.6659 5.806 19.2999 5.312C18.9362 4.82238 18.442 4.445 17.8739 4.223C17.3979 4.037 16.8649 4.006 16.1819 4.001C16.04 3.70147 15.8161 3.44838 15.536 3.27117C15.2559 3.09396 14.9313 2.99993 14.5999 3H10.5999ZM19.0179 9.896L18.6559 7.808C18.3729 6.768 18.2699 6.441 18.0959 6.207C17.9001 5.94311 17.6339 5.73968 17.3279 5.62C17.1079 5.534 16.8419 5.509 16.1799 5.502C16.0378 5.80066 15.8139 6.05293 15.5343 6.22956C15.2546 6.4062 14.9306 6.49996 14.5999 6.5H10.5999C10.2691 6.49996 9.94516 6.4062 9.66552 6.22956C9.38588 6.05293 9.16202 5.80066 9.01989 5.502C8.35689 5.509 8.09189 5.534 7.87189 5.62C7.56585 5.73968 7.2997 5.94311 7.10389 6.207C6.92989 6.441 6.82689 6.767 6.54389 7.807L6.18189 9.896C7.17989 9.75 8.50989 9.75 10.2849 9.75H14.9149C16.6899 9.75 18.0199 9.75 19.0179 9.896ZM8.59989 13C8.7988 13 8.98956 13.079 9.13022 13.2197C9.27087 13.3603 9.34989 13.5511 9.34989 13.75V17.75C9.34989 17.9489 9.27087 18.1397 9.13022 18.2803C8.98956 18.421 8.7988 18.5 8.59989 18.5C8.40097 18.5 8.21021 18.421 8.06956 18.2803C7.9289 18.1397 7.84989 17.9489 7.84989 17.75V13.75C7.84989 13.5511 7.9289 13.3603 8.06956 13.2197C8.21021 13.079 8.40097 13 8.59989 13ZM17.3499 13.75C17.3499 13.5511 17.2709 13.3603 17.1302 13.2197C16.9896 13.079 16.7988 13 16.5999 13C16.401 13 16.2102 13.079 16.0696 13.2197C15.9289 13.3603 15.8499 13.5511 15.8499 13.75V17.75C15.8499 17.9489 15.9289 18.1397 16.0696 18.2803C16.2102 18.421 16.401 18.5 16.5999 18.5C16.7988 18.5 16.9896 18.421 17.1302 18.2803C17.2709 18.1397 17.3499 17.9489 17.3499 17.75V13.75ZM12.5999 13C12.7988 13 12.9896 13.079 13.1302 13.2197C13.2709 13.3603 13.3499 13.5511 13.3499 13.75V17.75C13.3499 17.9489 13.2709 18.1397 13.1302 18.2803C12.9896 18.421 12.7988 18.5 12.5999 18.5C12.401 18.5 12.2102 18.421 12.0696 18.2803C11.9289 18.1397 11.8499 17.9489 11.8499 17.75V13.75C11.8499 13.5511 11.9289 13.3603 12.0696 13.2197C12.2102 13.079 12.401 13 12.5999 13Z\"\n                fill=\"white\"\n            />\n            </svg>\n\n            {{ btn_add_cart }}\n        </button>\n        </div>\n    </div>\n        `; // Add closing brace here\n\n          productContainer.appendChild(productElement);\n        }\n      }\n      document.querySelectorAll(\".add-to-carts\").forEach((button) => {\n        button.addEventListener(\"click\", function () {\n          const product = products.find(\n            (product) =>\n              product.item_code === button.getAttribute(\"item-code\")\n          );\n          addToCart(product);\n        });\n      });\n\n      displayPagination();\n      window.scrollTo(0, 0);\n    };\n\n    // code xu ly su kien\n\n    formFilter.addEventListener(\"change\", (event) => {\n      currentPage = 1;\n      getProducts();\n    });\n\n    // code xu ly phan trang\n\n    function displayPagination() {\n      const paginationContainer = document.getElementById(\"pagination-container\");\n      const prevPage = document.getElementById(\"prev-page\");\n      const nextPage = document.getElementById(\"next-page\");\n\n      currentPage === 1\n        ? prevPage?.classList.add(\"no-active\")\n        : prevPage.classList.remove(\"no-active\");\n      currentPage === totalPages\n        ? nextPage?.classList.add(\"no-active\")\n        : nextPage.classList.remove(\"no-active\");\n\n      totalPages > 1\n        ? paginationContainer.classList.remove(\"hidden\")\n        : paginationContainer.classList.add(\"hidden\");\n\n      paginationContainer\n        ?.querySelectorAll(\".page-number\")\n        ?.forEach((button) => button.remove());\n\n      for (let i = 1; i <= totalPages; i++) {\n        const pageButton = document.createElement(\"button\");\n        pageButton.innerText = i;\n        pageButton.className = `page-number text-lg text-[#222222] font-normal px-2 py-[1px] ${i === currentPage ? \"active\" : \"\"\n          }`;\n        pageButton.addEventListener(\"click\", () => {\n          if (currentPage !== i) {\n            currentPage = i;\n            getProducts();\n          }\n        });\n        paginationContainer?.insertBefore(\n          pageButton,\n          document.getElementById(\"next-page\")\n        );\n      }\n    }\n\n    // Thêm sự kiện click cho nút Previous\n    document.getElementById(\"prev-page\").addEventListener(\"click\", () => {\n      if (currentPage > 1) {\n        currentPage--;\n        getProducts();\n      }\n    });\n\n    // Thêm sự kiện click cho nút Next\n    document.getElementById(\"next-page\").addEventListener(\"click\", () => {\n      if (currentPage < totalPages) {\n        currentPage++;\n        getProducts();\n      }\n    });\n\n    //loading\n    function showLoading(show) {\n      // Hiển thị hoặc ẩn loading indicator\n      loadingIndicator.style.display = show ? \"flex\" : \"none\";\n    }\n\n    function disableUI(disable) {\n      // Vô hiệu hóa hoặc kích hoạt các checkbox và nút bấm\n      document.getElementById(\"list-products-filter\").disabled = disable;\n    }\n\n    textSearch.addEventListener(\"input\", () => {\n      clearTimeout(changeTimer);\n      changeTimer = setTimeout(() => {\n        currentPage = 1;\n        getProducts();\n      }, changeInterval);\n    });\n\n    const displayStar = () => {\n      const starContainers = document.querySelectorAll(\".star-container\");\n\n      starContainers.forEach(function (container) {\n        const rating = parseInt(container.getAttribute(\"data-rating\"));\n        const stars = container.querySelectorAll(\".fa-star\");\n\n        // Set the checked class to the stars according to the rating\n        for (let i = 0; i < rating; i++) {\n          stars[i].classList.add(\"checked\");\n        }\n      });\n    };\n\n    // add to cart\n\n    const apiAddToCart = \"/api/method/go1_cms.api.website.cart.update_cart\";\n\n    const addToCart = (product) => {\n      showLoading(true);\n      disableUI(true);\n      if (!checkLogin()) {\n        window.location.href = \"/dang-nhap\";\n        return;\n      }\n      fetch(apiAddToCart, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"X-Frappe-CSRF-Token\": \"{{csrf_token}}\",\n        },\n        body: JSON.stringify({\n          item_code: product.item_code,\n          qty: 1,\n          add_item: true,\n        }),\n      })\n        .then((response) => {\n          showLoading(false);\n          disableUI(false);\n          if (response.status === 403) {\n            window.location.href = \"/dang-nhap\";\n          } else if (!response.ok) {\n            Swal.fire({\n              icon: \"error\",\n              title: \"Có lỗi xảy ra, vui lòng thử lại sau\",\n              showConfirmButton: false,\n              timer: 1500,\n            });\n            throw new Error(\"Có lỗi xảy ra, vui lòng thử lại sau\");\n          } else {\n            return response.json();\n          }\n        })\n        .then((result) => {\n          if (checkLogin() && result) {\n            updateDisplayCart();\n            Swal.fire({\n              position: \"top-end\",\n              icon: \"success\",\n              title: \"Thêm vào giỏ hàng thành công\",\n              showConfirmButton: false,\n              timer: 1500,\n              toast: true,\n            });\n          }\n        })\n        .catch((error) => {\n          console.error(\"Error:\", error);\n        });\n    };\n\n    sortBy.addEventListener(\"change\", () => {\n      currentPage = 1;\n      getProducts();\n    });\n\n  </script>", "doctype": "Page Section", "content": [{"name": "3bd5f03c4e", "owner": "Administrator", "creation": "2024-10-16 11:47:09.637779", "modified": "2024-10-16 11:47:09.646404", "modified_by": "Administrator", "docstatus": 0, "idx": 1, "field_label": "Tiêu đề", "field_key": "title", "field_type": "Text", "content_type": "Data", "allow_update_to_style": 0, "content": "Sản phẩm", "parent": "PS-24-0000015017", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}, {"name": "d1b3e0a32d", "owner": "Administrator", "creation": "2024-10-16 11:47:09.637779", "modified": "2024-10-16 11:47:09.646404", "modified_by": "Administrator", "docstatus": 0, "idx": 2, "field_label": "Nhãn nút thêm vào giỏ", "field_key": "btn_add_cart", "field_type": "Text", "content_type": "Data", "allow_update_to_style": 0, "content": "Thêm vào giỏ hàng", "parent": "PS-24-0000015017", "parentfield": "content", "parenttype": "Page Section", "doctype": "Section Content"}], "section_column_css": [], "column_index": 1}]